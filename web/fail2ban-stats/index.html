<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fail2ban Statistics - leblais.net</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
            text-align: center;
        }
        
        header h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        header .subtitle {
            color: #666;
            font-size: 1.1em;
        }
        
        header .updated {
            color: #999;
            font-size: 0.9em;
            margin-top: 10px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-value {
            font-size: 3em;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .stat-label {
            color: #666;
            font-size: 1.1em;
            margin-top: 10px;
        }
        
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .chart-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .chart-card h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.5em;
        }
        
        .chart-container {
            position: relative;
            height: 300px;
        }
        
        .table-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        .table-card h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.5em;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: 600;
        }
        
        tr:hover {
            background: #f5f5f5;
        }
        
        .flag {
            font-size: 1.5em;
            margin-right: 10px;
        }
        
        @media (max-width: 768px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }
            
            header h1 {
                font-size: 1.8em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üõ°Ô∏è Fail2ban Statistics</h1>
            <div class="subtitle">leblais.net Security Dashboard</div>
            <div class="updated">Derni√®re mise √† jour : 17/11/2025 17:00:06 (heure de Paris)</div>
        </header>
        
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value">14</div>
                <div class="stat-label">Jails actifs</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">11</div>
                <div class="stat-label">IPs bannies</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">19376</div>
                <div class="stat-label">Tentatives totales</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">364</div>
                <div class="stat-label">Bans totaux</div>
            </div>
        </div>
        
        <div class="charts-grid">
            <div class="chart-card">
                <h2>üìç Top 15 pays</h2>
                <div class="chart-container">
                    <canvas id="countryChart"></canvas>
                </div>
            </div>
            
            <div class="chart-card">
                <h2>üìÖ Bans des 7 derniers jours</h2>
                <div class="chart-container">
                    <canvas id="dateChart"></canvas>
                </div>
            </div>
            
            <div class="chart-card">
                <h2>üïê Bans par heure des 7 derniers jours</h2>
                <div class="chart-container">
                    <canvas id="hourChart"></canvas>
                </div>
            </div>
            
            <div class="chart-card">
                <h2>üéØ Statistiques par Jail</h2>
                <div class="chart-container">
                    <canvas id="jailChart"></canvas>
                </div>
            </div>
        </div>
        
        <div class="table-card">
            <h2>üåç Top 20 IPs bannies</h2>
            <table>
                <thead>
                    <tr>
                        <th>Rang</th>
                        <th>IP</th>
                        <th>Pays</th>
                        <th>Occurrences</th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <td>1</td>
                        <td><code>117.50.192.225</code></td>
                        <td><span class="flag">üá®üá≥</span>China</td>
                        <td><strong>1</strong></td>
                    </tr>

                    <tr>
                        <td>2</td>
                        <td><code>220.161.147.22</code></td>
                        <td><span class="flag">üá®üá≥</span>China</td>
                        <td><strong>1</strong></td>
                    </tr>

                    <tr>
                        <td>3</td>
                        <td><code>45.78.217.238</code></td>
                        <td><span class="flag">üá∏üá¨</span>Singapore</td>
                        <td><strong>1</strong></td>
                    </tr>

                    <tr>
                        <td>4</td>
                        <td><code>2.57.121.112</code></td>
                        <td><span class="flag">üè¥</span>Romania</td>
                        <td><strong>1</strong></td>
                    </tr>

                    <tr>
                        <td>5</td>
                        <td><code>54.39.43.8</code></td>
                        <td><span class="flag">üè¥</span>Canada</td>
                        <td><strong>1</strong></td>
                    </tr>

                    <tr>
                        <td>6</td>
                        <td><code>160.250.130.217</code></td>
                        <td><span class="flag">üáªüá≥</span>Vietnam</td>
                        <td><strong>1</strong></td>
                    </tr>

                    <tr>
                        <td>7</td>
                        <td><code>140.0.3.10</code></td>
                        <td><span class="flag">üáÆüá©</span>Indonesia</td>
                        <td><strong>1</strong></td>
                    </tr>

                    <tr>
                        <td>8</td>
                        <td><code>156.248.11.152</code></td>
                        <td><span class="flag">üè¥</span>Hong Kong</td>
                        <td><strong>1</strong></td>
                    </tr>

                    <tr>
                        <td>9</td>
                        <td><code>84.241.12.245</code></td>
                        <td><span class="flag">üè¥</span>Iran</td>
                        <td><strong>1</strong></td>
                    </tr>

                    <tr>
                        <td>10</td>
                        <td><code>64.227.174.243</code></td>
                        <td><span class="flag">üáÆüá≥</span>India</td>
                        <td><strong>1</strong></td>
                    </tr>

                    <tr>
                        <td>11</td>
                        <td><code>165.232.84.59</code></td>
                        <td><span class="flag">üá≥üá±</span>The Netherlands</td>
                        <td><strong>1</strong></td>
                    </tr>

                </tbody>
            </table>
        </div>
        
        <div class="table-card">
            <h2>üéØ D√©tails par Jail</h2>
            
            <style>
            .jails-grid {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
                gap: 20px;
                margin-top: 20px;
            }
            
            .jail-card {
                background: white;
                border-radius: 12px;
                padding: 20px;
                box-shadow: 0 2px 8px rgba(0,0,0,0.08);
                transition: all 0.3s ease;
                border-left: 4px solid #cbd5e0;
                position: relative;
                overflow: hidden;
            }
            
            .jail-card::before {
                content: '';
                position: absolute;
                top: 0;
                right: 0;
                width: 100px;
                height: 100px;
                background: linear-gradient(135deg, rgba(102,126,234,0.05) 0%, transparent 100%);
                border-radius: 0 0 0 100%;
            }
            
            .jail-card:hover {
                transform: translateY(-3px);
                box-shadow: 0 4px 16px rgba(0,0,0,0.12);
            }
            
            .jail-card.has-bans {
                border-left-color: #f56565;
            }
            
            .jail-card.has-attempts {
                border-left-color: #ed8936;
            }
            
            .jail-card.meta {
                border-left-color: gold;
                background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
            }
            
            .jail-header {
                display: flex;
                align-items: center;
                justify-content: space-between;
                margin-bottom: 16px;
                position: relative;
                z-index: 1;
            }
            
            .jail-title {
                display: flex;
                align-items: center;
                gap: 10px;
            }
            
            .jail-icon {
                font-size: 1.6em;
            }
            
            .jail-name {
                font-size: 1em;
                font-weight: 600;
                color: #2d3748;
                font-family: 'Courier New', monospace;
            }
            
            .meta-badge {
                background: gold;
                color: #000;
                padding: 3px 10px;
                border-radius: 12px;
                font-size: 0.7em;
                font-weight: bold;
                white-space: nowrap;
            }
            
            .jail-stats {
                display: grid;
                grid-template-columns: repeat(3, 1fr);
                gap: 10px;
                position: relative;
                z-index: 1;
            }
            
            .stat-box {
                text-align: center;
                padding: 12px 8px;
                background: #f7fafc;
                border-radius: 8px;
                border: 1px solid #e2e8f0;
                transition: all 0.2s;
            }
            
            .stat-box:hover {
                background: #edf2f7;
            }
            
            .stat-box.active-bans {
                background: #fed7d7;
                border-color: #fc8181;
            }
            
            .stat-box.has-data {
                background: #fef5e7;
                border-color: #f6e05e;
            }
            
            .stat-number {
                font-size: 1.5em;
                font-weight: bold;
                color: #2d3748;
                line-height: 1;
            }
            
            .stat-box.active-bans .stat-number {
                color: #c53030;
            }
            
            .stat-box.has-data .stat-number {
                color: #d69e2e;
            }
            
            .stat-label {
                font-size: 0.7em;
                color: #718096;
                margin-top: 6px;
                text-transform: uppercase;
                letter-spacing: 0.3px;
                font-weight: 500;
            }
            
            @media (max-width: 768px) {
                .jails-grid {
                    grid-template-columns: 1fr;
                }
            }
            </style>
            
            <div class="jails-grid">

                <div class="jail-card">
                    <div class="jail-header">
                        <div class="jail-title">
                            <span class="jail-icon">üîí</span>
                            <span class="jail-name">caddy-bookmarks</span>
                        </div>

                    </div>
                    <div class="jail-stats">

                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Bannies</div>
                        </div>

                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Total bans</div>
                        </div>

                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Tentatives</div>
                        </div>

                    </div>
                </div>

                <div class="jail-card">
                    <div class="jail-header">
                        <div class="jail-title">
                            <span class="jail-icon">üîí</span>
                            <span class="jail-name">caddy-budget</span>
                        </div>

                    </div>
                    <div class="jail-stats">

                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Bannies</div>
                        </div>

                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Total bans</div>
                        </div>

                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Tentatives</div>
                        </div>

                    </div>
                </div>

                <div class="jail-card has-attempts">
                    <div class="jail-header">
                        <div class="jail-title">
                            <span class="jail-icon">‚öôÔ∏è</span>
                            <span class="jail-name">caddy-cockpit</span>
                        </div>

                    </div>
                    <div class="jail-stats">

                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Bannies</div>
                        </div>

                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Total bans</div>
                        </div>

                        <div class="stat-box has-data">
                            <div class="stat-number">1</div>
                            <div class="stat-label">Tentatives</div>
                        </div>

                    </div>
                </div>

                <div class="jail-card">
                    <div class="jail-header">
                        <div class="jail-title">
                            <span class="jail-icon">üóÇÔ∏è</span>
                            <span class="jail-name">caddy-files</span>
                        </div>

                    </div>
                    <div class="jail-stats">

                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Bannies</div>
                        </div>

                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Total bans</div>
                        </div>

                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Tentatives</div>
                        </div>

                    </div>
                </div>

                <div class="jail-card">
                    <div class="jail-header">
                        <div class="jail-title">
                            <span class="jail-icon">üì¶</span>
                            <span class="jail-name">caddy-freebox</span>
                        </div>

                    </div>
                    <div class="jail-stats">

                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Bannies</div>
                        </div>

                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Total bans</div>
                        </div>

                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Tentatives</div>
                        </div>

                    </div>
                </div>

                <div class="jail-card">
                    <div class="jail-header">
                        <div class="jail-title">
                            <span class="jail-icon">üì∞</span>
                            <span class="jail-name">caddy-freshrss</span>
                        </div>

                    </div>
                    <div class="jail-stats">

                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Bannies</div>
                        </div>

                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Total bans</div>
                        </div>

                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Tentatives</div>
                        </div>

                    </div>
                </div>

                <div class="jail-card has-attempts">
                    <div class="jail-header">
                        <div class="jail-title">
                            <span class="jail-icon">üîí</span>
                            <span class="jail-name">caddy-nextcloud</span>
                        </div>

                    </div>
                    <div class="jail-stats">

                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Bannies</div>
                        </div>

                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Total bans</div>
                        </div>

                        <div class="stat-box has-data">
                            <div class="stat-number">1</div>
                            <div class="stat-label">Tentatives</div>
                        </div>

                    </div>
                </div>

                <div class="jail-card has-attempts">
                    <div class="jail-header">
                        <div class="jail-title">
                            <span class="jail-icon">üîí</span>
                            <span class="jail-name">caddy-pihole</span>
                        </div>

                    </div>
                    <div class="jail-stats">

                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Bannies</div>
                        </div>

                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Total bans</div>
                        </div>

                        <div class="stat-box has-data">
                            <div class="stat-number">2</div>
                            <div class="stat-label">Tentatives</div>
                        </div>

                    </div>
                </div>

                <div class="jail-card has-attempts">
                    <div class="jail-header">
                        <div class="jail-title">
                            <span class="jail-icon">üíª</span>
                            <span class="jail-name">caddy-terminal</span>
                        </div>

                    </div>
                    <div class="jail-stats">

                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Bannies</div>
                        </div>

                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Total bans</div>
                        </div>

                        <div class="stat-box has-data">
                            <div class="stat-number">4</div>
                            <div class="stat-label">Tentatives</div>
                        </div>

                    </div>
                </div>

                <div class="jail-card has-attempts">
                    <div class="jail-header">
                        <div class="jail-title">
                            <span class="jail-icon">üåä</span>
                            <span class="jail-name">caddy-torrent</span>
                        </div>

                    </div>
                    <div class="jail-stats">

                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Bannies</div>
                        </div>

                        <div class="stat-box has-data">
                            <div class="stat-number">2</div>
                            <div class="stat-label">Total bans</div>
                        </div>

                        <div class="stat-box has-data">
                            <div class="stat-number">49</div>
                            <div class="stat-label">Tentatives</div>
                        </div>

                    </div>
                </div>

                <div class="jail-card">
                    <div class="jail-header">
                        <div class="jail-title">
                            <span class="jail-icon">üîí</span>
                            <span class="jail-name">caddy-uptime</span>
                        </div>

                    </div>
                    <div class="jail-stats">

                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Bannies</div>
                        </div>

                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Total bans</div>
                        </div>

                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Tentatives</div>
                        </div>

                    </div>
                </div>

                <div class="jail-card">
                    <div class="jail-header">
                        <div class="jail-title">
                            <span class="jail-icon">üîê</span>
                            <span class="jail-name">caddy-vaultwarden</span>
                        </div>

                    </div>
                    <div class="jail-stats">

                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Bannies</div>
                        </div>

                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Total bans</div>
                        </div>

                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Tentatives</div>
                        </div>

                    </div>
                </div>

                <div class="jail-card meta">
                    <div class="jail-header">
                        <div class="jail-title">
                            <span class="jail-icon">üìä</span>
                            <span class="jail-name">fail2ban-stats</span>
                        </div>

                        <span class="meta-badge">üõ°Ô∏è META</span>

                    </div>
                    <div class="jail-stats">

                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Bannies</div>
                        </div>

                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Total bans</div>
                        </div>

                        <div class="stat-box has-data">
                            <div class="stat-number">4</div>
                            <div class="stat-label">Tentatives</div>
                        </div>

                    </div>
                </div>

                <div class="jail-card has-bans">
                    <div class="jail-header">
                        <div class="jail-title">
                            <span class="jail-icon">üîë</span>
                            <span class="jail-name">sshd</span>
                        </div>

                    </div>
                    <div class="jail-stats">

                        <div class="stat-box active-bans">
                            <div class="stat-number">11</div>
                            <div class="stat-label">Bannies</div>
                        </div>

                        <div class="stat-box has-data">
                            <div class="stat-number">362</div>
                            <div class="stat-label">Total bans</div>
                        </div>

                        <div class="stat-box has-data">
                            <div class="stat-number">19,315</div>
                            <div class="stat-label">Tentatives</div>
                        </div>

                    </div>
                </div>

            </div>
        </div>
    </div>
    
    <script>
        Chart.register(ChartDataLabels);
        Chart.defaults.plugins.datalabels.display = false;
        
        const chartColors = {
            primary: '#667eea',
            secondary: '#764ba2',
            success: '#48bb78',
            warning: '#ed8936',
            danger: '#f56565'
        };
        
        // Graphique des pays
        const countryData = [{"code": "CN", "count": 2}, {"code": "SG", "count": 1}, {"code": "RO", "count": 1}, {"code": "CA", "count": 1}, {"code": "VN", "count": 1}, {"code": "ID", "count": 1}, {"code": "HK", "count": 1}, {"code": "IR", "count": 1}, {"code": "IN", "count": 1}, {"code": "NL", "count": 1}];
        new Chart(document.getElementById('countryChart'), {
            type: 'bar',
            data: {
                labels: countryData.map(c => c.code),
                datasets: [{
                    label: 'Nombre de bans',
                    data: countryData.map(c => c.count),
                    backgroundColor: chartColors.primary,
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    datalabels: {
                        display: true,
                        color: 'white',
                        font: { weight: 'bold' }
                    }
                },
                scales: {
                    y: { beginAtZero: true }
                }
            }
        });
        
        // Graphique des dates
        const dateData = {"2025-11-16": 164, "2025-11-17": 160};
        const sortedDates = Object.keys(dateData).sort();
        new Chart(document.getElementById('dateChart'), {
            type: 'line',
            data: {
                labels: sortedDates,
                datasets: [{
                    label: 'Bans par jour',
                    data: sortedDates.map(d => dateData[d]),
                    borderColor: chartColors.secondary,
                    backgroundColor: chartColors.secondary + '33',
                    fill: true,
                    tension: 0.4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false }
                },
                scales: {
                    y: { beginAtZero: true }
                }
            }
        });
        
        // Graphique des heures
        const hourData = {"00:00": 20, "01:00": 18, "02:00": 18, "03:00": 8, "04:00": 12, "05:00": 32, "06:00": 14, "07:00": 16, "08:00": 22, "09:00": 17, "10:00": 9, "11:00": 30, "12:00": 11, "13:00": 9, "14:00": 15, "15:00": 18, "16:00": 15, "17:00": 4, "18:00": 4, "19:00": 3, "20:00": 12, "21:00": 3, "22:00": 8, "23:00": 6};
        const hours = Array.from({length: 24}, (_, i) => `${String(i).padStart(2, '0')}:00`);
        new Chart(document.getElementById('hourChart'), {
            type: 'bar',
            data: {
                labels: hours,
                datasets: [{
                    label: 'Bans par heure',
                    data: hours.map(h => hourData[h] || 0),
                    backgroundColor: chartColors.success,
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false }
                },
                scales: {
                    y: { beginAtZero: true }
                }
            }
        });
        
        // Graphique des jails
        const jailData = {"caddy-bookmarks": {"currently_failed": 0, "total_failed": 0, "currently_banned": 0, "total_banned": 0, "banned_ips": []}, "caddy-budget": {"currently_failed": 0, "total_failed": 0, "currently_banned": 0, "total_banned": 0, "banned_ips": []}, "caddy-cockpit": {"currently_failed": 0, "total_failed": 1, "currently_banned": 0, "total_banned": 0, "banned_ips": []}, "caddy-files": {"currently_failed": 0, "total_failed": 0, "currently_banned": 0, "total_banned": 0, "banned_ips": []}, "caddy-freebox": {"currently_failed": 0, "total_failed": 0, "currently_banned": 0, "total_banned": 0, "banned_ips": []}, "caddy-freshrss": {"currently_failed": 0, "total_failed": 0, "currently_banned": 0, "total_banned": 0, "banned_ips": []}, "caddy-nextcloud": {"currently_failed": 0, "total_failed": 1, "currently_banned": 0, "total_banned": 0, "banned_ips": []}, "caddy-pihole": {"currently_failed": 0, "total_failed": 2, "currently_banned": 0, "total_banned": 0, "banned_ips": []}, "caddy-terminal": {"currently_failed": 0, "total_failed": 4, "currently_banned": 0, "total_banned": 0, "banned_ips": []}, "caddy-torrent": {"currently_failed": 0, "total_failed": 49, "currently_banned": 0, "total_banned": 2, "banned_ips": []}, "caddy-uptime": {"currently_failed": 0, "total_failed": 0, "currently_banned": 0, "total_banned": 0, "banned_ips": []}, "caddy-vaultwarden": {"currently_failed": 0, "total_failed": 0, "currently_banned": 0, "total_banned": 0, "banned_ips": []}, "fail2ban-stats": {"currently_failed": 0, "total_failed": 4, "currently_banned": 0, "total_banned": 0, "banned_ips": []}, "sshd": {"currently_failed": 6, "total_failed": 19315, "currently_banned": 11, "total_banned": 362, "banned_ips": ["64.227.174.243", "165.232.84.59", "84.241.12.245", "117.50.192.225", "220.161.147.22", "156.248.11.152", "2.57.121.112", "140.0.3.10", "54.39.43.8", "160.250.130.217", "45.78.217.238"]}};
        const jailNames = Object.keys(jailData);
        new Chart(document.getElementById('jailChart'), {
            type: 'doughnut',
            data: {
                labels: jailNames,
                datasets: [{
                    data: jailNames.map(j => jailData[j].total_banned),
                    backgroundColor: [
                        chartColors.primary,
                        chartColors.secondary,
                        chartColors.success,
                        chartColors.warning
                    ]
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom'
                    },
                    datalabels: {
                        display: true,
                        color: 'white',
                        font: { weight: 'bold', size: 16 }
                    }
                }
            }
        });
    </script>
</body>
</html>
